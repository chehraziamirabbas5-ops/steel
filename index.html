<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù‚Ø³Ø§Ø· ØªØ¹Ø§ÙˆÙ†ÛŒ ÙØ±Ù‡Ù†Ú¯ÛŒØ§Ù† Ù¾Ø±Ø³Ù†Ù„ Ú©Ø§Ø±Ø®Ø§Ù†Ø¬Ø§Øª Ø§Ø³ØªÛŒÙ„ Ø§Ù„Ø¨Ø±Ø² Ùˆ Ø®Ø±Ù… ØµÙ†Ø¹Øª</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ -->
    <script src="https://cdn.jsdelivr.net/npm/jalali-moment/dist/jalali-moment.browser.js"></script>
    <style>
        * {
            font-family: 'Tahoma', 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #2c3e50, #4a6491);
            color: white;
            padding: 25px 30px;
            text-align: center;
            border-bottom: 5px solid #3498db;
        }
        
        header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        header h1 i {
            color: #3498db;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background-color: #2c3e50;
            overflow: hidden;
        }
        
        .tab-button {
            background-color: inherit;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 18px 25px;
            font-size: 16px;
            color: white;
            transition: 0.3s;
            flex: 1;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .tab-button:hover {
            background-color: #34495e;
        }
        
        .tab-button.active {
            background-color: #3498db;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .tab-content.active {
            display: block;
        }
        
        h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        th {
            background-color: #2c3e50;
            color: white;
            font-weight: bold;
            padding: 15px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        td {
            padding: 12px 15px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        tr:hover {
            background-color: #f1f8ff;
        }
        
        .input-form {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #e9ecef;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 15px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 5px;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: #27ae60;
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-danger {
            background-color: #e74c3c;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-warning {
            background-color: #f39c12;
        }
        
        .btn-warning:hover {
            background-color: #d68910;
        }
        
        .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        
        .search-box {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }
        
        .search-box input {
            flex: 1;
        }
        
        .stats {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            flex: 1;
            min-width: 200px;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-top: 5px solid #3498db;
        }
        
        .stat-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #3498db;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #7f8c8d;
            border-top: 1px solid #eee;
        }
        
        .delete-btn {
            color: #e74c3c;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            padding: 5px 10px;
        }
        
        .paid {
            color: #27ae60;
            font-weight: bold;
        }
        
        .unpaid {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .debts-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 10px;
            padding: 10px;
        }
        
        .debt-item {
            padding: 8px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 4px;
            cursor: pointer;
            border: 1px solid #ddd;
        }
        
        .debt-item:hover {
            background: #e9ecef;
        }
        
        .debt-item.selected {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        @media (max-width: 768px) {
            .tab-button {
                padding: 12px 15px;
                font-size: 14px;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .stat-card {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-line"></i> Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù‚Ø³Ø§Ø· ØªØ¹Ø§ÙˆÙ†ÛŒ ÙØ±Ù‡Ù†Ú¯ÛŒØ§Ù† Ù¾Ø±Ø³Ù†Ù„ Ú©Ø§Ø±Ø®Ø§Ù†Ø¬Ø§Øª Ø§Ø³ØªÛŒÙ„ Ø§Ù„Ø¨Ø±Ø² Ùˆ Ø®Ø±Ù… ØµÙ†Ø¹Øª</h1>
            <p class="subtitle">Ø§Ù…ÙˆØ± Ú©Ø§Ø±Ú©Ù†Ø§Ù† ØµÙ†Ø§ÛŒØ¹ Ø§Ø³ØªÛŒÙ„ Ø§Ù„Ø¨Ø±Ø² - Ù†Ø³Ø®Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¨Ø§ Google Sheets</p>
            <div style="margin-top: 10px; font-size: 14px; background: rgba(255,255,255,0.1); padding: 5px 10px; border-radius: 3px; display: inline-block;">
                <i class="fas fa-cloud"></i> ÙˆØ¶Ø¹ÛŒØª: <span id="connectionStatus">Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„...</span>
            </div>
        </header>
        
        <div class="tabs">
            <button class="tab-button active" onclick="openTab(event, 'customers')">
                <i class="fas fa-users"></i> Ù…Ø´ØªØ±ÛŒØ§Ù†
            </button>
            <button class="tab-button" onclick="openTab(event, 'debts')">
                <i class="fas fa-file-invoice-dollar"></i> Ø«Ø¨Øª Ø¨Ø¯Ù‡ÛŒ
            </button>
            <button class="tab-button" onclick="openTab(event, 'payments')">
                <i class="fas fa-money-check-alt"></i> Ù¾Ø±Ø¯Ø§Ø®Øª Ù‚Ø³Ø·
            </button>
            <button class="tab-button" onclick="openTab(event, 'dashboard')">
                <i class="fas fa-tachometer-alt"></i> Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
            </button>
            <button class="tab-button" onclick="openTab(event, 'sync')">
                <i class="fas fa-sync-alt"></i> Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ
            </button>
        </div>
        
        <!-- ØªØ¨ Ù…Ø´ØªØ±ÛŒØ§Ù† -->
        <div id="customers" class="tab-content active">
            <h2><i class="fas fa-users"></i> Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø´ØªØ±ÛŒØ§Ù†</h2>
            
            <div class="input-form">
                <h3>Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø´ØªØ±ÛŒ Ø¬Ø¯ÛŒØ¯</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="employeeCode">Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ</label>
                        <input type="number" id="employeeCode" placeholder="Ù…Ø«Ø§Ù„: 1001">
                    </div>
                    <div class="form-group">
                        <label for="firstName">Ù†Ø§Ù…</label>
                        <input type="text" id="firstName" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù„ÛŒ">
                    </div>
                    <div class="form-group">
                        <label for="lastName">Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
                        <input type="text" id="lastName" placeholder="Ù…Ø«Ø§Ù„: Ø±Ø¶Ø§ÛŒÛŒ">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="nationalCode">Ú©Ø¯ Ù…Ù„ÛŒ</label>
                        <input type="text" id="nationalCode" placeholder="Ù…Ø«Ø§Ù„: 0012345678">
                    </div>
                    <div class="form-group">
                        <label for="hireDate">ØªØ§Ø±ÛŒØ® Ø§Ø³ØªØ®Ø¯Ø§Ù… (Ø´Ù…Ø³ÛŒ)</label>
                        <input type="text" id="hireDate" placeholder="1400/01/01">
                    </div>
                    <div class="form-group">
                        <label for="status">ÙˆØ¶Ø¹ÛŒØª</label>
                        <select id="status">
                            <option value="ÙØ¹Ø§Ù„">ÙØ¹Ø§Ù„</option>
                            <option value="ØºÛŒØ±ÙØ¹Ø§Ù„">ØºÛŒØ±ÙØ¹Ø§Ù„</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="addCustomer()">
                    <i class="fas fa-user-plus"></i> Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø´ØªØ±ÛŒ (Ø¢Ù†Ù„Ø§ÛŒÙ† + Ø¢ÙÙ„Ø§ÛŒÙ†)
                </button>
                <button class="btn" onclick="syncCustomers()">
                    <i class="fas fa-sync"></i> Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Google Sheets
                </button>
            </div>
            
            <div class="search-box">
                <input type="text" id="searchCustomer" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ø´ØªØ±ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ø§Ù…ØŒ Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ ÛŒØ§ Ú©Ø¯ Ù…Ù„ÛŒ...">
                <button class="btn" onclick="searchCustomers()">
                    <i class="fas fa-search"></i> Ø¬Ø³ØªØ¬Ùˆ
                </button>
                <button class="btn btn-warning" onclick="clearSearch()">
                    <i class="fas fa-times"></i> Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†
                </button>
            </div>
            
            <table id="customersTable">
                <thead>
                    <tr>
                        <th>Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ</th>
                        <th>Ù†Ø§Ù…</th>
                        <th>Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</th>
                        <th>Ú©Ø¯ Ù…Ù„ÛŒ</th>
                        <th>ØªØ§Ø±ÛŒØ® Ø§Ø³ØªØ®Ø¯Ø§Ù…</th>
                        <th>ÙˆØ¶Ø¹ÛŒØª</th>
                        <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                    </tr>
                </thead>
                <tbody id="customersTableBody">
                    <!-- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÙˆÛŒØ§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </tbody>
            </table>
            
            <div class="actions">
                <button class="btn" onclick="exportToCSV('customers')">
                    <i class="fas fa-file-export"></i> Ø®Ø±ÙˆØ¬ÛŒ Excel (CSV)
                </button>
                <button class="btn btn-danger" onclick="clearAllCustomers()">
                    <i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ù‡Ù…Ù‡ Ù…Ø´ØªØ±ÛŒØ§Ù† (Ù…Ø­Ù„ÛŒ)
                </button>
            </div>
        </div>
        
        <!-- ØªØ¨ Ø«Ø¨Øª Ø¨Ø¯Ù‡ÛŒ -->
        <div id="debts" class="tab-content">
            <h2><i class="fas fa-file-invoice-dollar"></i> Ø«Ø¨Øª Ø¨Ø¯Ù‡ÛŒ Ùˆ Ø§Ù‚Ø³Ø§Ø·</h2>
            
            <div class="input-form">
                <h3>Ø«Ø¨Øª Ø¨Ø¯Ù‡ÛŒ Ø¬Ø¯ÛŒØ¯</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="debtEmployeeCode">Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ù…Ø´ØªØ±ÛŒ</label>
                        <input type="number" id="debtEmployeeCode" placeholder="Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                        <button class="btn" style="margin-top: 5px; width: 100%;" onclick="findCustomerByCode()">
                            <i class="fas fa-search"></i> Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù…Ø´ØªØ±ÛŒ
                        </button>
                    </div>
                    <div class="form-group">
                        <label for="debtCustomerName">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
                        <input type="text" id="debtCustomerName" readonly>
                    </div>
                    <div class="form-group">
                        <label for="debtAmount">Ù…Ø¨Ù„Øº Ú©Ù„ Ø¨Ø¯Ù‡ÛŒ (Ø±ÛŒØ§Ù„)</label>
                        <input type="number" id="debtAmount" placeholder="Ù…Ø«Ø§Ù„: 10000000">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="installmentCount">ØªØ¹Ø¯Ø§Ø¯ Ø§Ù‚Ø³Ø§Ø·</label>
                        <select id="installmentCount">
                            <option value="1">1 Ù‚Ø³Ø·</option>
                            <option value="2">2 Ù‚Ø³Ø·</option>
                            <option value="3">3 Ù‚Ø³Ø·</option>
                            <option value="4">4 Ù‚Ø³Ø·</option>
                            <option value="5">5 Ù‚Ø³Ø·</option>
                            <option value="6">6 Ù‚Ø³Ø·</option>
                            <option value="7">7 Ù‚Ø³Ø·</option>
                            <option value="8">8 Ù‚Ø³Ø·</option>
                            <option value="9">9 Ù‚Ø³Ø·</option>
                            <option value="10">10 Ù‚Ø³Ø·</option>
                            <option value="11">11 Ù‚Ø³Ø·</option>
                            <option value="12">12 Ù‚Ø³Ø·</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="installmentAmount">Ù…Ø¨Ù„Øº Ù‡Ø± Ù‚Ø³Ø· (Ø±ÛŒØ§Ù„)</label>
                        <input type="number" id="installmentAmount" readonly>
                    </div>
                    <div class="form-group">
                        <label for="debtDate">ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª (Ø´Ù…Ø³ÛŒ)</label>
                        <input type="text" id="debtDate" placeholder="1402/10/15">
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="addDebt()">
                    <i class="fas fa-save"></i> Ø«Ø¨Øª Ø¨Ø¯Ù‡ÛŒ (Ø¢Ù†Ù„Ø§ÛŒÙ† + Ø¢ÙÙ„Ø§ÛŒÙ†)
                </button>
                <button class="btn" onclick="calculateInstallment()">
                    <i class="fas fa-calculator"></i> Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù‚Ø³Ø§Ø·
                </button>
            </div>
            
            <table id="debtsTable">
                <thead>
                    <tr>
                        <th>Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯</th>
                        <th>Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ</th>
                        <th>Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ</th>
                        <th>Ù…Ø¨Ù„Øº Ú©Ù„</th>
                        <th>ØªØ¹Ø¯Ø§Ø¯ Ø§Ù‚Ø³Ø§Ø·</th>
                        <th>Ù…Ø¨Ù„Øº Ù‡Ø± Ù‚Ø³Ø·</th>
                        <th>ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª</th>
                        <th>ÙˆØ¶Ø¹ÛŒØª</th>
                        <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                    </tr>
                </thead>
                <tbody id="debtsTableBody">
                    <!-- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÙˆÛŒØ§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </tbody>
            </table>
            
            <div class="actions">
                <button class="btn" onclick="exportToCSV('debts')">
                    <i class="fas fa-file-export"></i> Ø®Ø±ÙˆØ¬ÛŒ Excel (CSV)
                </button>
            </div>
        </div>
        
        <!-- ØªØ¨ Ù¾Ø±Ø¯Ø§Ø®Øª Ù‚Ø³Ø· -->
        <div id="payments" class="tab-content">
            <h2><i class="fas fa-money-check-alt"></i> Ø«Ø¨Øª Ù¾Ø±Ø¯Ø§Ø®Øª Ù‚Ø³Ø·</h2>
            
            <div class="input-form">
                <h3>Ø«Ø¨Øª Ù¾Ø±Ø¯Ø§Ø®Øª Ø¬Ø¯ÛŒØ¯</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="paymentEmployeeCode">Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ</label>
                        <input type="number" id="paymentEmployeeCode" placeholder="Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                        <button class="btn" style="margin-top: 5px; width: 100%;" onclick="findCustomerForPayment()">
                            <i class="fas fa-search"></i> Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù…Ø´ØªØ±ÛŒ
                        </button>
                    </div>
                    <div class="form-group">
                        <label for="paymentCustomerName">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
                        <input type="text" id="paymentCustomerName" readonly>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø´ØªØ±ÛŒ</label>
                        <div id="customerDebtsList" class="debts-list">
                            <!-- Ù„ÛŒØ³Øª Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÙˆÛŒØ§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                        </div>
                        <input type="hidden" id="selectedDebtId">
                    </div>
                    <div class="form-group">
                        <label for="paymentAmount">Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ (Ø±ÛŒØ§Ù„)</label>
                        <input type="number" id="paymentAmount" placeholder="Ù…Ø¨Ù„Øº Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="installmentNumber">Ø´Ù…Ø§Ø±Ù‡ Ù‚Ø³Ø·</label>
                        <input type="number" id="installmentNumber" placeholder="Ù…Ø«Ø§Ù„: 1">
                    </div>
                    <div class="form-group">
                        <label for="paymentDate">ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª (Ø´Ù…Ø³ÛŒ)</label>
                        <input type="text" id="paymentDate" placeholder="1402/10/15">
                    </div>
                    <div class="form-group">
                        <label for="paymentMonth">Ù…Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª</label>
                        <select id="paymentMonth">
                            <option value="ÙØ±ÙˆØ±Ø¯ÛŒÙ†">ÙØ±ÙˆØ±Ø¯ÛŒÙ†</option>
                            <option value="Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª">Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª</option>
                            <option value="Ø®Ø±Ø¯Ø§Ø¯">Ø®Ø±Ø¯Ø§Ø¯</option>
                            <option value="ØªÛŒØ±">ØªÛŒØ±</option>
                            <option value="Ù…Ø±Ø¯Ø§Ø¯">Ù…Ø±Ø¯Ø§Ø¯</option>
                            <option value="Ø´Ù‡Ø±ÛŒÙˆØ±">Ø´Ù‡Ø±ÛŒÙˆØ±</option>
                            <option value="Ù…Ù‡Ø±">Ù…Ù‡Ø±</option>
                            <option value="Ø¢Ø¨Ø§Ù†">Ø¢Ø¨Ø§Ù†</option>
                            <option value="Ø¢Ø°Ø±">Ø¢Ø°Ø±</option>
                            <option value="Ø¯ÛŒ">Ø¯ÛŒ</option>
                            <option value="Ø¨Ù‡Ù…Ù†">Ø¨Ù‡Ù…Ù†</option>
                            <option value="Ø§Ø³ÙÙ†Ø¯">Ø§Ø³ÙÙ†Ø¯</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="paymentYear">Ø³Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª</label>
                        <input type="number" id="paymentYear" placeholder="1402" value="1402">
                    </div>
                    <div class="form-group">
                        <label for="paymentDescription">ØªÙˆØ¶ÛŒØ­Ø§Øª</label>
                        <input type="text" id="paymentDescription" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ù¾Ø±Ø¯Ø§Ø®Øª">
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="addPayment()">
                    <i class="fas fa-money-bill-wave"></i> Ø«Ø¨Øª Ù¾Ø±Ø¯Ø§Ø®Øª (Ø¢Ù†Ù„Ø§ÛŒÙ† + Ø¢ÙÙ„Ø§ÛŒÙ†)
                </button>
            </div>
            
            <table id="paymentsTable">
                <thead>
                    <tr>
                        <th>Ø´Ù…Ø§Ø±Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª</th>
                        <th>Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ</th>
                        <th>Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ</th>
                        <th>Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯</th>
                        <th>Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ</th>
                        <th>Ø´Ù…Ø§Ø±Ù‡ Ù‚Ø³Ø·</th>
                        <th>ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª</th>
                        <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                    </tr>
                </thead>
                <tbody id="paymentsTableBody">
                    <!-- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÙˆÛŒØ§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </tbody>
            </table>
            
            <div class="actions">
                <button class="btn" onclick="exportToCSV('payments')">
                    <i class="fas fa-file-export"></i> Ø®Ø±ÙˆØ¬ÛŒ Excel (CSV)
                </button>
            </div>
        </div>
        
        <!-- ØªØ¨ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ -->
        <div id="dashboard" class="tab-content">
            <h2><i class="fas fa-tachometer-alt"></i> Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø¢Ù…Ø§Ø±ÛŒ</h2>
            
            <div class="stats">
                <div class="stat-card">
                    <h3>ØªØ¹Ø¯Ø§Ø¯ Ù…Ø´ØªØ±ÛŒØ§Ù† ÙØ¹Ø§Ù„</h3>
                    <div class="stat-value" id="activeCustomers">0</div>
                </div>
                
                <div class="stat-card">
                    <h3>Ù…Ø¬Ù…ÙˆØ¹ Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø§Ø±ÛŒ</h3>
                    <div class="stat-value" id="totalDebts">0 Ø±ÛŒØ§Ù„</div>
                </div>
                
                <div class="stat-card">
                    <h3>Ù…Ø¬Ù…ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø®ØªÛŒâ€ŒÙ‡Ø§</h3>
                    <div class="stat-value" id="totalPayments">0 Ø±ÛŒØ§Ù„</div>
                </div>
                
                <div class="stat-card">
                    <h3>Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø¹ÙˆÙ‚</h3>
                    <div class="stat-value" id="overdueDebts">0 Ù…ÙˆØ±Ø¯</div>
                </div>
            </div>
            
            <h3>Ø¬Ø³ØªØ¬ÙˆÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø¯Ù‡ÛŒ Ù…Ø´ØªØ±ÛŒ</h3>
            <div class="search-box">
                <input type="number" id="dashboardEmployeeCode" placeholder="Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ù…Ø´ØªØ±ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                <button class="btn" onclick="searchCustomerDebts()">
                    <i class="fas fa-search"></i> Ø¬Ø³ØªØ¬Ùˆ
                </button>
            </div>
            
            <div id="customerDebtResult" style="margin-top: 20px;">
                <!-- Ù†ØªØ§ÛŒØ¬ Ø¬Ø³ØªØ¬Ùˆ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
            </div>
            
            <h3 style="margin-top: 30px;">Ú¯Ø²Ø§Ø±Ø´ Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù‡ Ø¬Ø§Ø±ÛŒ</h3>
            <div class="form-row" style="margin-bottom: 20px;">
                <div class="form-group">
                    <label for="reportMonth">Ù…Ø§Ù‡</label>
                    <select id="reportMonth">
                        <option value="ÙØ±ÙˆØ±Ø¯ÛŒÙ†">ÙØ±ÙˆØ±Ø¯ÛŒÙ†</option>
                        <option value="Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª">Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª</option>
                        <option value="Ø®Ø±Ø¯Ø§Ø¯">Ø®Ø±Ø¯Ø§Ø¯</option>
                        <option value="ØªÛŒØ±">ØªÛŒØ±</option>
                        <option value="Ù…Ø±Ø¯Ø§Ø¯">Ù…Ø±Ø¯Ø§Ø¯</option>
                        <option value="Ø´Ù‡Ø±ÛŒÙˆØ±">Ø´Ù‡Ø±ÛŒÙˆØ±</option>
                        <option value="Ù…Ù‡Ø±">Ù…Ù‡Ø±</option>
                        <option value="Ø¢Ø¨Ø§Ù†">Ø¢Ø¨Ø§Ù†</option>
                        <option value="Ø¢Ø°Ø±">Ø¢Ø°Ø±</option>
                        <option value="Ø¯ÛŒ">Ø¯ÛŒ</option>
                        <option value="Ø¨Ù‡Ù…Ù†">Ø¨Ù‡Ù…Ù†</option>
                        <option value="Ø§Ø³ÙÙ†Ø¯">Ø§Ø³ÙÙ†Ø¯</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="reportYear">Ø³Ø§Ù„</label>
                    <input type="number" id="reportYear" value="1402">
                </div>
                <div class="form-group">
                    <label style="visibility: hidden;">.</label>
                    <button class="btn" onclick="generateMonthlyReport()">
                        <i class="fas fa-chart-bar"></i> Ø§ÛŒØ¬Ø§Ø¯ Ú¯Ø²Ø§Ø±Ø´
                    </button>
                </div>
            </div>
            
            <table id="monthlyReportTable">
                <thead>
                    <tr>
                        <th>Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ</th>
                        <th>Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ</th>
                        <th>Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯</th>
                        <th>Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ</th>
                        <th>Ø´Ù…Ø§Ø±Ù‡ Ù‚Ø³Ø·</th>
                        <th>ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª</th>
                    </tr>
                </thead>
                <tbody id="monthlyReportTableBody">
                    <!-- Ú¯Ø²Ø§Ø±Ø´ Ù…Ø§Ù‡Ø§Ù†Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                </tbody>
            </table>
        </div>
        
        <!-- ØªØ¨ Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ -->
        <div id="sync" class="tab-content">
            <h2><i class="fas fa-sync-alt"></i> Ù…Ø¯ÛŒØ±ÛŒØª Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ Google Sheets</h2>
            
            <div class="input-form">
                <h3>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ØªØµØ§Ù„</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ø¢Ø¯Ø±Ø³ API Ø´Ù…Ø§:</label>
                        <input type="text" value="https://script.google.com/macros/s/AKfycbwRYQFZknKbcgSBOJtkWlHI7NOA6paRLTPrnWAeV_MhX4A6ElrtIChQMuratsLoNa2W/exec" readonly style="background: #f0f0f0;">
                        <small>Ø§ÛŒÙ† API Ø¨Ù‡ Google Sheets Ø´Ù…Ø§ Ù…ØªØµÙ„ Ø§Ø³Øª</small>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„:</label>
                        <div id="apiStatus" style="padding: 10px; background: #f8f9fa; border-radius: 5px; margin-top: 5px;">
                            <i class="fas fa-circle-notch fa-spin"></i> Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ØªØ§Ø±ÛŒØ® Ø¢Ø®Ø±ÛŒÙ† Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ:</label>
                        <div id="lastSync" style="padding: 10px; background: #f8f9fa; border-radius: 5px; margin-top: 5px;">
                            Ù‡Ù†ÙˆØ² Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
                        </div>
                    </div>
                </div>
                
                <div class="actions">
                    <button class="btn btn-success" onclick="testConnection()">
                        <i class="fas fa-wifi"></i> ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ API
                    </button>
                    <button class="btn" onclick="syncAllData()">
                        <i class="fas fa-sync-alt"></i> Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                    </button>
                    <button class="btn btn-warning" onclick="downloadFullBackup()">
                        <i class="fas fa-download"></i> Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ú©Ø§Ù…Ù„
                    </button>
                </div>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <h3>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ</h3>
                    <div class="stat-value" id="localCustomers">0</div>
                    <small>Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø±</small>
                </div>
                
                <div class="stat-card">
                    <h3>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ†</h3>
                    <div class="stat-value" id="onlineCustomers">0</div>
                    <small>Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¯Ø± Google Sheets</small>
                </div>
                
                <div class="stat-card">
                    <h3>ÙˆØ¶Ø¹ÛŒØª Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ</h3>
                    <div class="stat-value" id="syncStatus">--</div>
                    <small>Ø¢Ø®Ø±ÛŒÙ† ÙˆØ¶Ø¹ÛŒØª</small>
                </div>
                
                <div class="stat-card">
                    <h3>Ø­Ø¬Ù… Ø¯Ø§Ø¯Ù‡</h3>
                    <div class="stat-value" id="dataSize">0 KB</div>
                    <small>Ú©Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</small>
                </div>
            </div>
            
            <h3>Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h3>
            <div class="input-form">
                <div class="actions">
                    <button class="btn" onclick="uploadToSheets()">
                        <i class="fas fa-cloud-upload-alt"></i> Ø¢Ù¾Ù„ÙˆØ¯ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Google Sheets
                    </button>
                    <button class="btn" onclick="downloadFromSheets()">
                        <i class="fas fa-cloud-download-alt"></i> Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ø² Google Sheets
                    </button>
                    <button class="btn btn-danger" onclick="clearLocalData()">
                        <i class="fas fa-trash"></i> Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ
                    </button>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; border-right: 4px solid #3498db;">
                    <h4><i class="fas fa-info-circle"></i> Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ:</h4>
                    <ul style="margin-top: 10px; padding-right: 20px;">
                        <li><strong>Ø§ØªØµØ§Ù„ Ø¢Ù†Ù„Ø§ÛŒÙ†:</strong> Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù‡Ù… Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ùˆ Ù‡Ù… Ø¯Ø± Google Sheets Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</li>
                        <li><strong>Ø­Ø§Ù„Øª Ø¢ÙÙ„Ø§ÛŒÙ†:</strong> Ø§Ú¯Ø± Ø§ÛŒÙ†ØªØ±Ù†Øª Ù‚Ø·Ø¹ Ø´ÙˆØ¯ØŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</li>
                        <li><strong>Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±:</strong> Ù‡Ø± Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡ ÛŒÚ©Ø¨Ø§Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù‡Ù…Ú¯Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</li>
                        <li><strong>Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ:</strong> Ù‡Ø± Ø±ÙˆØ² ÛŒÚ©Ø¨Ø§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ú©Ø§Ù…Ù„ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Ø·Ø±Ø§Ø­ÛŒ ØªÙˆØ³Ø· Ø§Ø³ØªØ§Ø¯ Ø§Ø¹Ø¸Ù… Ø§Ù…ÛŒØ±Ø¹Ø¨Ø§Ø³ Ú†Ù‡Ø±Ø§Ø²ÛŒ | Ù†Ø³Ø®Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¨Ø§ Google Sheets</p>
            <p>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Google Sheets Ùˆ Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</p>
            <div style="margin-top: 10px;">
                <button class="btn" onclick="backupData()">
                    <i class="fas fa-download"></i> Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                </button>
                <button class="btn btn-warning" onclick="restoreData()">
                    <i class="fas fa-upload"></i> Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                </button>
                <button class="btn" onclick="openGoogleSheets()">
                    <i class="fab fa-google"></i> Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Google Sheets
                </button>
            </div>
        </div>
    </div>

    <script>
        // ==================== ØªÙ†Ø¸ÛŒÙ…Ø§Øª API ====================
        const GOOGLE_SHEETS_API = 'https://script.google.com/macros/s/AKfycbwRYQFZknKbcgSBOJtkWlHI7NOA6paRLTPrnWAeV_MhX4A6ElrtIChQMuratsLoNa2W/exec';
        
        // ==================== Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ====================
        let customers = JSON.parse(localStorage.getItem('customers')) || [];
        let debts = JSON.parse(localStorage.getItem('debts')) || [];
        let payments = JSON.parse(localStorage.getItem('payments')) || [];
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ ====================
        
        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± localStorage Ùˆ Google Sheets
        async function saveData() {
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
            localStorage.setItem('customers', JSON.stringify(customers));
            localStorage.setItem('debts', JSON.stringify(debts));
            localStorage.setItem('payments', JSON.stringify(payments));
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Google Sheets (Ø§Ú¯Ø± Ø¢Ù†Ù„Ø§ÛŒÙ† Ù‡Ø³ØªÛŒÙ…)
            try {
                await saveToGoogleSheets();
                showMessage('âœ… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Google Sheets Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯', 'success');
            } catch (error) {
                showMessage('âš  Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ ÙÙ‚Ø· Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯', 'warning');
            }
            
            updateDashboardStats();
            updateSyncStats();
        }
        
        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Google Sheets
        async function saveToGoogleSheets() {
            try {
                // Ø§Ø±Ø³Ø§Ù„ Ù…Ø´ØªØ±ÛŒØ§Ù†
                for (const customer of customers) {
                    await fetch(GOOGLE_SHEETS_API, {
                        method: 'POST',
                        mode: 'no-cors',
                        body: JSON.stringify({
                            action: 'add',
                            type: 'customers',
                            data: customer
                        })
                    });
                }
                
                // Ø§Ø±Ø³Ø§Ù„ Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§
                for (const debt of debts) {
                    await fetch(GOOGLE_SHEETS_API, {
                        method: 'POST',
                        mode: 'no-cors',
                        body: JSON.stringify({
                            action: 'add',
                            type: 'debts',
                            data: debt
                        })
                    });
                }
                
                // Ø§Ø±Ø³Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§
                for (const payment of payments) {
                    await fetch(GOOGLE_SHEETS_API, {
                        method: 'POST',
                        mode: 'no-cors',
                        body: JSON.stringify({
                            action: 'add',
                            type: 'payments',
                            data: payment
                        })
                    });
                }
                
                localStorage.setItem('lastSync', new Date().toLocaleString('fa-IR'));
                return true;
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Google Sheets:', error);
                return false;
            }
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² Google Sheets
        async function loadFromGoogleSheets(type) {
            try {
                // Ø³Ø§Ø®Øª ÛŒÚ© Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª
                const timestamp = new Date().getTime();
                const response = await fetch(`${GOOGLE_SHEETS_API}?action=getAll&type=${type}&_=${timestamp}`);
                
                if (!response.ok) {
                    throw new Error('Ù¾Ø§Ø³Ø® Ø³Ø±ÙˆØ± Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª');
                }
                
                const result = await response.json();
                if (result.success) {
                    return result.data || [];
                } else {
                    throw new Error(result.error || 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡');
                }
            } catch (error) {
                console.log(`Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† ${type} Ø§Ø² Google Sheets:`, error);
                return [];
            }
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', async function() {
            // ØªÙ†Ø¸ÛŒÙ… ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ² Ø´Ù…Ø³ÛŒ
            const today = moment().format('jYYYY/jMM/jDD');
            document.getElementById('hireDate').value = today;
            document.getElementById('debtDate').value = today;
            document.getElementById('paymentDate').value = today;
            
            // ØªÙ†Ø¸ÛŒÙ… Ø³Ø§Ù„ Ø¬Ø§Ø±ÛŒ Ø´Ù…Ø³ÛŒ
            const currentYear = moment().format('jYYYY');
            document.getElementById('paymentYear').value = currentYear;
            document.getElementById('reportYear').value = currentYear;
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ
            loadCustomers();
            loadDebts();
            loadPayments();
            updateDashboardStats();
            updateSyncStats();
            
            // ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ API
            testConnection();
            
            // ØªÙ†Ø¸ÛŒÙ… Ø±ÙˆÛŒØ¯Ø§Ø¯ ØªØºÛŒÛŒØ± Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù‚Ø³Ø§Ø·
            document.getElementById('debtAmount').addEventListener('input', calculateInstallment);
            document.getElementById('installmentCount').addEventListener('change', calculateInstallment);
            
            // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ø´ØªØ±ÛŒ
            document.getElementById('searchCustomer').addEventListener('input', function() {
                if (this.value === '') {
                    loadCustomers();
                }
            });
            
            // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡
            setInterval(async () => {
                if (navigator.onLine) {
                    await syncAllData();
                }
            }, 5 * 60 * 1000); // Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡
        });
        
        // ==================== Ù…Ø¯ÛŒØ±ÛŒØª ØªØ¨â€ŒÙ‡Ø§ ====================
        function openTab(evt, tabName) {
            const tabcontents = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabcontents.length; i++) {
                tabcontents[i].classList.remove("active");
            }
            
            const tabbuttons = document.getElementsByClassName("tab-button");
            for (let i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
            
            if (tabName === 'dashboard') {
                updateDashboardStats();
            } else if (tabName === 'sync') {
                updateSyncStats();
                testConnection();
            }
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ù…Ø´ØªØ±ÛŒØ§Ù† ====================
        function loadCustomers() {
            const tbody = document.getElementById('customersTableBody');
            tbody.innerHTML = '';
            
            customers.forEach(customer => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${customer.employee_code || customer.id}</td>
                    <td>${customer.first_name || customer.firstName}</td>
                    <td>${customer.last_name || customer.lastName}</td>
                    <td>${customer.national_code || customer.nationalCode}</td>
                    <td>${customer.hire_date || customer.hireDate}</td>
                    <td>${customer.status}</td>
                    <td>
                        <button class="delete-btn" onclick="deleteCustomer(${customer.employee_code || customer.id})" title="Ø­Ø°Ù">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        async function addCustomer() {
            const employeeCode = parseInt(document.getElementById('employeeCode').value);
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const nationalCode = document.getElementById('nationalCode').value.trim();
            const hireDate = document.getElementById('hireDate').value.trim();
            const status = document.getElementById('status').value;
            
            if (!employeeCode || !firstName || !lastName || !nationalCode || !hireDate) {
                showMessage('Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ Ù†Ø¨ÙˆØ¯Ù† Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ
            if (customers.some(c => (c.employee_code || c.id) === employeeCode)) {
                showMessage('Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ Ø§Ø³Øª', 'error');
                return;
            }
            
            // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ
            if (!isValidJalaliDate(hireDate)) {
                showMessage('ØªØ§Ø±ÛŒØ® Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª. Ù„Ø·ÙØ§Ù‹ ØªØ§Ø±ÛŒØ® Ø±Ø§ Ø¨Ù‡ ÙØ±Ù…Øª Ø´Ù…Ø³ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ø§Ù„: 1400/01/01)', 'error');
                return;
            }
            
            const newCustomer = {
                employee_code: employeeCode,
                first_name: firstName,
                last_name: lastName,
                national_code: nationalCode,
                hire_date: hireDate,
                status: status,
                created_at: new Date().toISOString()
            };
            
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø¢Ø±Ø§ÛŒÙ‡ Ù…Ø­Ù„ÛŒ
            customers.push(newCustomer);
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
            localStorage.setItem('customers', JSON.stringify(customers));
            
            // ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Google Sheets
            let onlineSaved = false;
            if (navigator.onLine) {
                try {
                    await fetch(GOOGLE_SHEETS_API, {
                        method: 'POST',
                        mode: 'no-cors',
                        body: JSON.stringify({
                            action: 'add',
                            type: 'customers',
                            data: newCustomer
                        })
                    });
                    onlineSaved = true;
                } catch (error) {
                    console.log('Ø°Ø®ÛŒØ±Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ† Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯');
                }
            }
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØºØ§Ù…
            loadCustomers();
            updateDashboardStats();
            updateSyncStats();
            
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙØ±Ù…
            document.getElementById('employeeCode').value = '';
            document.getElementById('firstName').value = '';
            document.getElementById('lastName').value = '';
            document.getElementById('nationalCode').value = '';
            document.getElementById('hireDate').value = moment().format('jYYYY/jMM/jDD');
            
            if (onlineSaved) {
                showMessage('âœ… Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯ (Ø¢Ù†Ù„Ø§ÛŒÙ† + Ø¢ÙÙ„Ø§ÛŒÙ†)', 'success');
            } else {
                showMessage('âš  Ù…Ø´ØªØ±ÛŒ Ø¨Ù‡ ØµÙˆØ±Øª Ø¢ÙÙ„Ø§ÛŒÙ† Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ (Ø¯Ø± Ø§ÙˆÙ„ÛŒÙ† ÙØ±ØµØª Ø¢Ù†Ù„Ø§ÛŒÙ† Ù‡Ù…Ú¯Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯)', 'warning');
            }
        }
        
        async function deleteCustomer(id) {
            if (!confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ù…Ø´ØªØ±ÛŒ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
                return;
            }
            
            // Ø­Ø°Ù Ø§Ø² Ø¢Ø±Ø§ÛŒÙ‡ Ù…Ø­Ù„ÛŒ
            customers = customers.filter(c => (c.employee_code || c.id) !== id);
            
            // Ø­Ø°Ù Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§ Ùˆ Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡
            const customerDebts = debts.filter(d => d.employee_code === id);
            customerDebts.forEach(debt => {
                payments = payments.filter(p => p.debt_id !== debt.id);
            });
            debts = debts.filter(d => d.employee_code !== id);
            
            // Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª
            saveData();
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯
            loadCustomers();
            loadDebts();
            loadPayments();
            updateDashboardStats();
            updateSyncStats();
            
            showMessage('Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯', 'success');
        }
        
        function searchCustomers() {
            const query = document.getElementById('searchCustomer').value.toLowerCase().trim();
            if (!query) {
                loadCustomers();
                return;
            }
            
            const filtered = customers.filter(c => 
                (c.employee_code || c.id).toString().includes(query) ||
                (c.first_name || c.firstName).toLowerCase().includes(query) ||
                (c.last_name || c.lastName).toLowerCase().includes(query) ||
                (c.national_code || c.nationalCode).includes(query)
            );
            
            const tbody = document.getElementById('customersTableBody');
            tbody.innerHTML = '';
            
            filtered.forEach(customer => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${customer.employee_code || customer.id}</td>
                    <td>${customer.first_name || customer.firstName}</td>
                    <td>${customer.last_name || customer.lastName}</td>
                    <td>${customer.national_code || customer.nationalCode}</td>
                    <td>${customer.hire_date || customer.hireDate}</td>
                    <td>${customer.status}</td>
                    <td>
                        <button class="delete-btn" onclick="deleteCustomer(${customer.employee_code || customer.id})" title="Ø­Ø°Ù">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function clearSearch() {
            document.getElementById('searchCustomer').value = '';
            loadCustomers();
        }
        
        async function clearAllCustomers() {
            if (!confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù ØªÙ…Ø§Ù… Ù…Ø´ØªØ±ÛŒØ§Ù† Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ Ø§ÛŒÙ† Ø¹Ù…Ù„ Ù‚Ø§Ø¨Ù„ Ø¨Ø±Ú¯Ø´Øª Ù†ÛŒØ³Øª.')) {
                return;
            }
            
            customers = [];
            debts = [];
            payments = [];
            
            await saveData();
            
            loadCustomers();
            loadDebts();
            loadPayments();
            updateDashboardStats();
            updateSyncStats();
            
            showMessage('Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø­Ø°Ù Ø´Ø¯Ù†Ø¯', 'success');
        }
        
        async function syncCustomers() {
            showMessage('ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¨Ø§ Google Sheets...', 'info');
            
            try {
                // Ø®ÙˆØ§Ù†Ø¯Ù† Ø§Ø² Google Sheets
                const onlineCustomers = await loadFromGoogleSheets('customers');
                
                if (onlineCustomers.length > 0) {
                    // Ø§Ø¯ØºØ§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                    const merged = [...customers];
                    
                    onlineCustomers.forEach(online => {
                        const exists = merged.some(local => 
                            (local.employee_code || local.id) === (online.employee_code || online.id)
                        );
                        
                        if (!exists) {
                            merged.push(online);
                        }
                    });
                    
                    customers = merged;
                    
                    // Ø°Ø®ÛŒØ±Ù‡
                    localStorage.setItem('customers', JSON.stringify(customers));
                    loadCustomers();
                    updateSyncStats();
                    
                    showMessage(`âœ… ${onlineCustomers.length} Ù…Ø´ØªØ±ÛŒ Ø§Ø² Google Sheets Ù‡Ù…Ú¯Ø§Ù… Ø´Ø¯`, 'success');
                } else {
                    showMessage('Ù‡ÛŒÚ† Ù…Ø´ØªØ±ÛŒ Ø¯Ø± Google Sheets ÛŒØ§ÙØª Ù†Ø´Ø¯', 'info');
                }
            } catch (error) {
                showMessage('âŒ Ø®Ø·Ø§ Ø¯Ø± Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ù…Ø´ØªØ±ÛŒØ§Ù†', 'error');
            }
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§ ====================
        function loadDebts() {
            const tbody = document.getElementById('debtsTableBody');
            tbody.innerHTML = '';
            
            debts.forEach(debt => {
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡
                const paid = payments.filter(p => p.debt_id === debt.id)
                    .reduce((sum, p) => sum + p.amount, 0);
                
                // ØªØ¹ÛŒÛŒÙ† ÙˆØ¶Ø¹ÛŒØª
                let status = debt.status;
                if (paid >= debt.amount) {
                    status = "ØªØ³ÙˆÛŒÙ‡ Ø´Ø¯Ù‡";
                } else if (paid > 0) {
                    status = "Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª";
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${debt.id}</td>
                    <td>${debt.employee_code}</td>
                    <td>${debt.customer_name}</td>
                    <td>${formatCurrency(debt.amount)}</td>
                    <td>${debt.installments}</td>
                    <td>${formatCurrency(debt.installment_amount)}</td>
                    <td>${debt.date}</td>
                    <td class="${status === 'ØªØ³ÙˆÛŒÙ‡ Ø´Ø¯Ù‡' ? 'paid' : 'unpaid'}">${status}</td>
                    <td>
                        <button class="delete-btn" onclick="deleteDebt(${debt.id})" title="Ø­Ø°Ù">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function findCustomerByCode() {
            const code = parseInt(document.getElementById('debtEmployeeCode').value);
            if (!code) {
                showMessage('Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            const customer = customers.find(c => (c.employee_code || c.id) === code);
            if (customer) {
                document.getElementById('debtCustomerName').value = `${customer.first_name || customer.firstName} ${customer.last_name || customer.lastName}`;
                calculateInstallment();
            } else {
                showMessage('Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯', 'error');
                document.getElementById('debtCustomerName').value = '';
            }
        }
        
        function calculateInstallment() {
            const amount = parseInt(document.getElementById('debtAmount').value) || 0;
            const installments = parseInt(document.getElementById('installmentCount').value) || 1;
            
            if (amount > 0 && installments > 0) {
                const installmentAmount = Math.round(amount / installments);
                document.getElementById('installmentAmount').value = installmentAmount;
            }
        }
        
        async function addDebt() {
            const employeeCode = parseInt(document.getElementById('debtEmployeeCode').value);
            const customerName = document.getElementById('debtCustomerName').value.trim();
            const amount = parseInt(document.getElementById('debtAmount').value);
            const installments = parseInt(document.getElementById('installmentCount').value);
            const installmentAmount = parseInt(document.getElementById('installmentAmount').value);
            const date = document.getElementById('debtDate').value.trim();
            
            if (!employeeCode || !customerName || !amount || !installments || !date) {
                showMessage('Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ù…Ø´ØªØ±ÛŒ
            const customer = customers.find(c => (c.employee_code || c.id) === employeeCode);
            if (!customer) {
                showMessage('Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯', 'error');
                return;
            }
            
            // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ
            if (!isValidJalaliDate(date)) {
                showMessage('ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª. Ù„Ø·ÙØ§Ù‹ ØªØ§Ø±ÛŒØ® Ø±Ø§ Ø¨Ù‡ ÙØ±Ù…Øª Ø´Ù…Ø³ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ø§Ù„: 1402/10/15)', 'error');
                return;
            }
            
            // ØªÙˆÙ„ÛŒØ¯ Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯ Ø¬Ø¯ÛŒØ¯
            const newId = debts.length > 0 ? Math.max(...debts.map(d => d.id)) + 1 : 5001;
            
            const newDebt = {
                id: newId,
                employee_code: employeeCode,
                customer_name: customerName,
                amount: amount,
                installments: installments,
                installment_amount: installmentAmount,
                date: date,
                status: "Ø¬Ø§Ø±ÛŒ",
                paid_amount: 0,
                created_at: new Date().toISOString()
            };
            
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø¢Ø±Ø§ÛŒÙ‡ Ù…Ø­Ù„ÛŒ
            debts.push(newDebt);
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
            localStorage.setItem('debts', JSON.stringify(debts));
            
            // ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Google Sheets
            let onlineSaved = false;
            if (navigator.onLine) {
                try {
                    await fetch(GOOGLE_SHEETS_API, {
                        method: 'POST',
                        mode: 'no-cors',
                        body: JSON.stringify({
                            action: 'add',
                            type: 'debts',
                            data: newDebt
                        })
                    });
                    onlineSaved = true;
                } catch (error) {
                    console.log('Ø°Ø®ÛŒØ±Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ† Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯');
                }
            }
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯
            loadDebts();
            updateDashboardStats();
            updateSyncStats();
            
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙØ±Ù…
            document.getElementById('debtEmployeeCode').value = '';
            document.getElementById('debtCustomerName').value = '';
            document.getElementById('debtAmount').value = '';
            document.getElementById('installmentAmount').value = '';
            document.getElementById('debtDate').value = moment().format('jYYYY/jMM/jDD');
            
            if (onlineSaved) {
                showMessage('âœ… Ø¨Ø¯Ù‡ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯ (Ø¢Ù†Ù„Ø§ÛŒÙ† + Ø¢ÙÙ„Ø§ÛŒÙ†)', 'success');
            } else {
                showMessage('âš  Ø¨Ø¯Ù‡ÛŒ Ø¨Ù‡ ØµÙˆØ±Øª Ø¢ÙÙ„Ø§ÛŒÙ† Ø«Ø¨Øª Ø´Ø¯ (Ø¯Ø± Ø§ÙˆÙ„ÛŒÙ† ÙØ±ØµØª Ø¢Ù†Ù„Ø§ÛŒÙ† Ù‡Ù…Ú¯Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯)', 'warning');
            }
        }
        
        async function deleteDebt(id) {
            if (!confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ø¨Ø¯Ù‡ÛŒ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
                return;
            }
            
            debts = debts.filter(d => d.id !== id);
            payments = payments.filter(p => p.debt_id !== id);
            
            await saveData();
            
            loadDebts();
            loadPayments();
            updateDashboardStats();
            updateSyncStats();
            
            showMessage('Ø¨Ø¯Ù‡ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯', 'success');
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§ ====================
        function loadPayments() {
            const tbody = document.getElementById('paymentsTableBody');
            tbody.innerHTML = '';
            
            payments.forEach(payment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${payment.id}</td>
                    <td>${payment.employee_code}</td>
                    <td>${payment.customer_name}</td>
                    <td>${payment.debt_id}</td>
                    <td>${formatCurrency(payment.amount)}</td>
                    <td>${payment.installment_number}</td>
                    <td>${payment.date}</td>
                    <td>
                        <button class="delete-btn" onclick="deletePayment(${payment.id})" title="Ø­Ø°Ù">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function findCustomerForPayment() {
            const employeeCode = parseInt(document.getElementById('paymentEmployeeCode').value);
            if (!employeeCode) {
                showMessage('Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            const customer = customers.find(c => (c.employee_code || c.id) === employeeCode);
            if (!customer) {
                showMessage('Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯', 'error');
                document.getElementById('paymentCustomerName').value = '';
                document.getElementById('customerDebtsList').innerHTML = '';
                document.getElementById('selectedDebtId').value = '';
                return;
            }
            
            document.getElementById('paymentCustomerName').value = `${customer.first_name || customer.firstName} ${customer.last_name || customer.lastName}`;
            
            // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø´ØªØ±ÛŒ
            const customerDebts = debts.filter(d => d.employee_code === employeeCode);
            const debtsList = document.getElementById('customerDebtsList');
            debtsList.innerHTML = '';
            
            if (customerDebts.length === 0) {
                debtsList.innerHTML = '<div style="color: #999; text-align: center; padding: 20px;">Ø§ÛŒÙ† Ù…Ø´ØªØ±ÛŒ Ù‡ÛŒÚ† Ø¨Ø¯Ù‡ÛŒ ÙØ¹Ø§Ù„ÛŒ Ù†Ø¯Ø§Ø±Ø¯</div>';
                document.getElementById('selectedDebtId').value = '';
                return;
            }
            
            customerDebts.forEach(debt => {
                const paid = payments.filter(p => p.debt_id === debt.id)
                    .reduce((sum, p) => sum + p.amount, 0);
                const remaining = debt.amount - paid;
                const paidInstallments = payments.filter(p => p.debt_id === debt.id).length;
                
                const debtItem = document.createElement('div');
                debtItem.className = 'debt-item';
                debtItem.innerHTML = `
                    <strong>Ø³Ù†Ø¯ ${debt.id}</strong><br>
                    Ù…Ø¨Ù„Øº Ú©Ù„: ${formatCurrency(debt.amount)}<br>
                    Ù‚Ø³Ø·: ${paidInstallments}/${debt.installments}<br>
                    Ù…Ø§Ù†Ø¯Ù‡: ${formatCurrency(remaining)}
                `;
                
                debtItem.onclick = function() {
                    document.querySelectorAll('.debt-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    
                    this.classList.add('selected');
                    document.getElementById('selectedDebtId').value = debt.id;
                    
                    const nextInstallment = paidInstallments + 1;
                    document.getElementById('installmentNumber').value = nextInstallment;
                    document.getElementById('paymentAmount').value = debt.installment_amount;
                };
                
                debtsList.appendChild(debtItem);
            });
            
            if (customerDebts.length > 0) {
                debtsList.firstChild.click();
            }
        }
        
        async function addPayment() {
            const employeeCode = parseInt(document.getElementById('paymentEmployeeCode').value);
            const customerName = document.getElementById('paymentCustomerName').value.trim();
            const debtId = parseInt(document.getElementById('selectedDebtId').value);
            const amount = parseInt(document.getElementById('paymentAmount').value);
            const installmentNumber = parseInt(document.getElementById('installmentNumber').value);
            const date = document.getElementById('paymentDate').value.trim();
            const month = document.getElementById('paymentMonth').value;
            const year = document.getElementById('paymentYear').value;
            const description = document.getElementById('paymentDescription').value.trim();
            
            if (!employeeCode || !customerName || !debtId || !amount || !installmentNumber || !date) {
                showMessage('Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯ Ùˆ ÛŒÚ© Ø¨Ø¯Ù‡ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù…Ø§ÛŒÛŒØ¯', 'error');
                return;
            }
            
            const debt = debts.find(d => d.id === debtId);
            if (!debt) {
                showMessage('Ø¨Ø¯Ù‡ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯', 'error');
                return;
            }
            
            if (!isValidJalaliDate(date)) {
                showMessage('ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª. Ù„Ø·ÙØ§Ù‹ ØªØ§Ø±ÛŒØ® Ø±Ø§ Ø¨Ù‡ ÙØ±Ù…Øª Ø´Ù…Ø³ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ø§Ù„: 1402/10/15)', 'error');
                return;
            }
            
            const existingPayment = payments.find(p => p.debt_id === debtId && p.installment_number === installmentNumber);
            if (existingPayment) {
                if (!confirm(`Ù‚Ø³Ø· Ø´Ù…Ø§Ø±Ù‡ ${installmentNumber} Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¢Ù† Ø±Ø§ Ø¨Ø§Ø²Ù†ÙˆÛŒØ³ÛŒ Ú©Ù†ÛŒØ¯ØŸ`)) {
                    return;
                }
                payments = payments.filter(p => !(p.debt_id === debtId && p.installment_number === installmentNumber));
            }
            
            const newId = payments.length > 0 ? Math.max(...payments.map(p => p.id)) + 1 : 8001;
            
            const newPayment = {
                id: newId,
                debt_id: debtId,
                employee_code: employeeCode,
                customer_name: customerName,
                amount: amount,
                installment_number: installmentNumber,
                date: date,
                month: month,
                year: year,
                description: description || `Ù‚Ø³Ø· Ø´Ù…Ø§Ø±Ù‡ ${installmentNumber}`,
                created_at: new Date().toISOString()
            };
            
            payments.push(newPayment);
            
            localStorage.setItem('payments', JSON.stringify(payments));
            
            let onlineSaved = false;
            if (navigator.onLine) {
                try {
                    await fetch(GOOGLE_SHEETS_API, {
                        method: 'POST',
                        mode: 'no-cors',
                        body: JSON.stringify({
                            action: 'add',
                            type: 'payments',
                            data: newPayment
                        })
                    });
                    onlineSaved = true;
                } catch (error) {
                    console.log('Ø°Ø®ÛŒØ±Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ† Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯');
                }
            }
            
            loadPayments();
            loadDebts();
            updateDashboardStats();
            updateSyncStats();
            
            document.getElementById('paymentEmployeeCode').value = '';
            document.getElementById('paymentCustomerName').value = '';
            document.getElementById('customerDebtsList').innerHTML = '';
            document.getElementById('selectedDebtId').value = '';
            document.getElementById('paymentAmount').value = '';
            document.getElementById('installmentNumber').value = '';
            document.getElementById('paymentDate').value = moment().format('jYYYY/jMM/jDD');
            document.getElementById('paymentDescription').value = '';
            
            if (onlineSaved) {
                showMessage('âœ… Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯ (Ø¢Ù†Ù„Ø§ÛŒÙ† + Ø¢ÙÙ„Ø§ÛŒÙ†)', 'success');
            } else {
                showMessage('âš  Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ù‡ ØµÙˆØ±Øª Ø¢ÙÙ„Ø§ÛŒÙ† Ø«Ø¨Øª Ø´Ø¯ (Ø¯Ø± Ø§ÙˆÙ„ÛŒÙ† ÙØ±ØµØª Ø¢Ù†Ù„Ø§ÛŒÙ† Ù‡Ù…Ú¯Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯)', 'warning');
            }
        }
        
        async function deletePayment(id) {
            if (!confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
                return;
            }
            
            payments = payments.filter(p => p.id !== id);
            await saveData();
            
            loadPayments();
            loadDebts();
            updateDashboardStats();
            updateSyncStats();
            
            showMessage('Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯', 'success');
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ====================
        function updateDashboardStats() {
            const activeCustomersCount = customers.filter(c => c.status === 'ÙØ¹Ø§Ù„').length;
            document.getElementById('activeCustomers').textContent = activeCustomersCount;
            
            const totalDebtsAmount = debts
                .filter(d => {
                    const paid = payments.filter(p => p.debt_id === d.id)
                        .reduce((sum, p) => sum + p.amount, 0);
                    return paid < d.amount;
                })
                .reduce((sum, d) => sum + d.amount, 0);
            document.getElementById('totalDebts').textContent = formatCurrency(totalDebtsAmount);
            
            const totalPaymentsAmount = payments.reduce((sum, p) => sum + p.amount, 0);
            document.getElementById('totalPayments').textContent = formatCurrency(totalPaymentsAmount);
            
            let overdueCount = 0;
            const currentDate = moment();
            
            debts.forEach(debt => {
                const paid = payments.filter(p => p.debt_id === debt.id)
                    .reduce((sum, p) => sum + p.amount, 0);
                
                if (paid < debt.amount) {
                    const debtDate = moment(debt.date, 'jYYYY/jMM/jDD');
                    const monthsSinceDebt = currentDate.diff(debtDate, 'jMonth');
                    
                    if (monthsSinceDebt >= debt.installments) {
                        overdueCount++;
                    }
                }
            });
            
            document.getElementById('overdueDebts').textContent = overdueCount + ' Ù…ÙˆØ±Ø¯';
        }
        
        function searchCustomerDebts() {
            const code = parseInt(document.getElementById('dashboardEmployeeCode').value);
            if (!code) {
                showMessage('Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            const customer = customers.find(c => (c.employee_code || c.id) === code);
            if (!customer) {
                document.getElementById('customerDebtResult').innerHTML = 
                    '<div style="color: red; padding: 15px; background: #ffe6e6; border-radius: 5px;">Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</div>';
                return;
            }
            
            const customerDebts = debts.filter(d => d.employee_code === code);
            const customerPayments = payments.filter(p => p.employee_code === code);
            
            let html = `<div style="background: #f8f9fa; padding: 20px; border-radius: 5px;">
                <h4>ÙˆØ¶Ø¹ÛŒØª Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ ${customer.first_name || customer.firstName} ${customer.last_name || customer.lastName}</h4>`;
            
            if (customerDebts.length === 0) {
                html += '<p>Ø§ÛŒÙ† Ù…Ø´ØªØ±ÛŒ Ù‡ÛŒÚ† Ø¨Ø¯Ù‡ÛŒ Ø«Ø¨Øª Ø´Ø¯Ù‡â€ŒØ§ÛŒ Ù†Ø¯Ø§Ø±Ø¯.</p>';
            } else {
                let totalDebt = 0;
                let totalPaid = 0;
                
                customerDebts.forEach(debt => {
                    const paid = payments.filter(p => p.debt_id === debt.id)
                        .reduce((sum, p) => sum + p.amount, 0);
                    const remaining = debt.amount - paid;
                    const paidInstallments = payments.filter(p => p.debt_id === debt.id).length;
                    
                    totalDebt += debt.amount;
                    totalPaid += paid;
                    
                    html += `
                        <div style="margin: 15px 0; padding: 15px; background: white; border-radius: 5px; border-right: 5px solid ${remaining > 0 ? '#e74c3c' : '#27ae60'}">
                            <strong>Ø³Ù†Ø¯ Ø´Ù…Ø§Ø±Ù‡ ${debt.id}:</strong> ${formatCurrency(debt.amount)}<br>
                            <strong>ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª:</strong> ${debt.date}<br>
                            <strong>ØªØ¹Ø¯Ø§Ø¯ Ø§Ù‚Ø³Ø§Ø·:</strong> ${debt.installments} Ù‚Ø³Ø·<br>
                            <strong>Ø§Ù‚Ø³Ø§Ø· Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡:</strong> ${paidInstallments} Ø§Ø² ${debt.installments}<br>
                            <strong>Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡:</strong> ${formatCurrency(paid)}<br>
                            <strong>Ù…Ø§Ù†Ø¯Ù‡ Ø¨Ø¯Ù‡ÛŒ:</strong> ${formatCurrency(remaining)}<br>
                            <strong>ÙˆØ¶Ø¹ÛŒØª:</strong> ${remaining > 0 ? 'Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª' : 'ØªØ³ÙˆÛŒÙ‡ Ø´Ø¯Ù‡'}
                        </div>
                    `;
                });
                
                html += `
                    <div style="margin-top: 20px; padding: 15px; background: #2c3e50; color: white; border-radius: 5px;">
                        <strong>Ø¬Ù…Ø¹ Ú©Ù„ Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§:</strong> ${formatCurrency(totalDebt)}<br>
                        <strong>Ø¬Ù…Ø¹ Ú©Ù„ Ù¾Ø±Ø¯Ø§Ø®ØªÛŒâ€ŒÙ‡Ø§:</strong> ${formatCurrency(totalPaid)}<br>
                        <strong>Ù…Ø§Ù†Ø¯Ù‡ Ú©Ù„:</strong> ${formatCurrency(totalDebt - totalPaid)}
                    </div>
                `;
            }
            
            html += `</div>`;
            document.getElementById('customerDebtResult').innerHTML = html;
        }
        
        function generateMonthlyReport() {
            const month = document.getElementById('reportMonth').value;
            const year = document.getElementById('reportYear').value;
            
            const monthlyPayments = payments.filter(p => p.month === month && p.year.toString() === year.toString());
            
            const tbody = document.getElementById('monthlyReportTableBody');
            tbody.innerHTML = '';
            
            if (monthlyPayments.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 20px; color: #7f8c8d;">
                            Ù‡ÛŒÚ† Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ Ø¨Ø±Ø§ÛŒ ${month} ${year} Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
                        </td>
                    </tr>
                `;
                return;
            }
            
            monthlyPayments.forEach(payment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${payment.employee_code}</td>
                    <td>${payment.customer_name}</td>
                    <td>${payment.debt_id}</td>
                    <td>${formatCurrency(payment.amount)}</td>
                    <td>${payment.installment_number}</td>
                    <td>${payment.date}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ ====================
        async function testConnection() {
            const statusDiv = document.getElementById('apiStatus');
            const connectionStatus = document.getElementById('connectionStatus');
            
            statusDiv.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ø§ØªØµØ§Ù„...';
            connectionStatus.textContent = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ø§ØªØµØ§Ù„...';
            
            try {
                const response = await fetch(GOOGLE_SHEETS_API);
                
                if (response.ok) {
                    statusDiv.innerHTML = '<i class="fas fa-check-circle" style="color: #27ae60;"></i> Ø§ØªØµØ§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø± Ø§Ø³Øª - API ÙØ¹Ø§Ù„';
                    connectionStatus.textContent = 'Ø¢Ù†Ù„Ø§ÛŒÙ†';
                    connectionStatus.style.color = '#27ae60';
                    
                    // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ø®Ø±ÛŒÙ† Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ
                    const lastSync = localStorage.getItem('lastSync') || 'Ù‡Ù†ÙˆØ² Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª';
                    document.getElementById('lastSync').textContent = lastSync;
                    
                    return true;
                } else {
                    throw new Error('Ù¾Ø§Ø³Ø® Ø³Ø±ÙˆØ± Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª');
                }
            } catch (error) {
                statusDiv.innerHTML = '<i class="fas fa-times-circle" style="color: #e74c3c;"></i> Ø§ØªØµØ§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø± Ù†ÛŒØ³Øª - Ø­Ø§Ù„Øª Ø¢ÙÙ„Ø§ÛŒÙ†';
                connectionStatus.textContent = 'Ø¢ÙÙ„Ø§ÛŒÙ†';
                connectionStatus.style.color = '#e74c3c';
                return false;
            }
        }
        
        async function syncAllData() {
            showMessage('ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Google Sheets...', 'info');
            
            try {
                // Ø®ÙˆØ§Ù†Ø¯Ù† Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² Google Sheets
                const [onlineCustomers, onlineDebts, onlinePayments] = await Promise.all([
                    loadFromGoogleSheets('customers'),
                    loadFromGoogleSheets('debts'),
                    loadFromGoogleSheets('payments')
                ]);
                
                // Ø§Ø¯ØºØ§Ù… Ù…Ø´ØªØ±ÛŒØ§Ù†
                if (onlineCustomers.length > 0) {
                    const mergedCustomers = [...customers];
                    onlineCustomers.forEach(online => {
                        const exists = mergedCustomers.some(local => 
                            (local.employee_code || local.id) === (online.employee_code || online.id)
                        );
                        if (!exists) {
                            mergedCustomers.push(online);
                        }
                    });
                    customers = mergedCustomers;
                }
                
                // Ø§Ø¯ØºØ§Ù… Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§
                if (onlineDebts.length > 0) {
                    const mergedDebts = [...debts];
                    onlineDebts.forEach(online => {
                        const exists = mergedDebts.some(local => local.id === online.id);
                        if (!exists) {
                            mergedDebts.push(online);
                        }
                    });
                    debts = mergedDebts;
                }
                
                // Ø§Ø¯ØºØ§Ù… Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§
                if (onlinePayments.length > 0) {
                    const mergedPayments = [...payments];
                    onlinePayments.forEach(online => {
                        const exists = mergedPayments.some(local => local.id === online.id);
                        if (!exists) {
                            mergedPayments.push(online);
                        }
                    });
                    payments = mergedPayments;
                }
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø¯ØºØ§Ù… Ø´Ø¯Ù‡
                localStorage.setItem('customers', JSON.stringify(customers));
                localStorage.setItem('debts', JSON.stringify(debts));
                localStorage.setItem('payments', JSON.stringify(payments));
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø²Ù…Ø§Ù† Ø¢Ø®Ø±ÛŒÙ† Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ
                localStorage.setItem('lastSync', new Date().toLocaleString('fa-IR'));
                
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯
                loadCustomers();
                loadDebts();
                loadPayments();
                updateDashboardStats();
                updateSyncStats();
                
                showMessage(`âœ… Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯. ${onlineCustomers.length} Ù…Ø´ØªØ±ÛŒØŒ ${onlineDebts.length} Ø¨Ø¯Ù‡ÛŒØŒ ${onlinePayments.length} Ù¾Ø±Ø¯Ø§Ø®Øª`, 'success');
                
                return true;
            } catch (error) {
                showMessage('âŒ Ø®Ø·Ø§ Ø¯Ø± Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§', 'error');
                return false;
            }
        }
        
        function updateSyncStats() {
            // Ø¢Ù…Ø§Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ
            document.getElementById('localCustomers').textContent = customers.length;
            
            // Ø¢Ù…Ø§Ø± Ø­Ø¬Ù… Ø¯Ø§Ø¯Ù‡
            const customersSize = JSON.stringify(customers).length;
            const debtsSize = JSON.stringify(debts).length;
            const paymentsSize = JSON.stringify(payments).length;
            const totalSize = customersSize + debtsSize + paymentsSize;
            const totalSizeKB = (totalSize / 1024).toFixed(2);
            document.getElementById('dataSize').textContent = `${totalSizeKB} KB`;
            
            // ÙˆØ¶Ø¹ÛŒØª Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ
            const lastSync = localStorage.getItem('lastSync');
            if (lastSync) {
                document.getElementById('syncStatus').textContent = 'Ù‡Ù…Ú¯Ø§Ù… Ø´Ø¯Ù‡';
                document.getElementById('syncStatus').style.color = '#27ae60';
            } else {
                document.getElementById('syncStatus').textContent = 'Ù‡Ù…Ú¯Ø§Ù… Ù†Ø´Ø¯Ù‡';
                document.getElementById('syncStatus').style.color = '#e74c3c';
            }
            
            // Ø¢Ù¾Ø¯ÛŒØª ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„
            if (navigator.onLine) {
                document.getElementById('connectionStatus').textContent = 'Ø¢Ù†Ù„Ø§ÛŒÙ†';
                document.getElementById('connectionStatus').style.color = '#27ae60';
            } else {
                document.getElementById('connectionStatus').textContent = 'Ø¢ÙÙ„Ø§ÛŒÙ†';
                document.getElementById('connectionStatus').style.color = '#e74c3c';
            }
        }
        
        async function uploadToSheets() {
            if (!confirm('Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ Ø±Ø§ Ø¨Ù‡ Google Sheets Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯ØŸ')) {
                return;
            }
            
            showMessage('ğŸ”¼ Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù¾Ù„ÙˆØ¯ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Google Sheets...', 'info');
            
            try {
                const success = await saveToGoogleSheets();
                
                if (success) {
                    showMessage('âœ… Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡ Google Sheets Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯Ù†Ø¯', 'success');
                    localStorage.setItem('lastSync', new Date().toLocaleString('fa-IR'));
                    updateSyncStats();
                } else {
                    showMessage('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ù„ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Google Sheets', 'error');
                }
            } catch (error) {
                showMessage('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ù„ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§', 'error');
            }
        }
        
        async function downloadFromSheets() {
            if (!confirm('Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø² Google Sheets Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯ØŸ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ ÙØ¹Ù„ÛŒ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.')) {
                return;
            }
            
            showMessage('ğŸ”½ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² Google Sheets...', 'info');
            
            try {
                await syncAllData();
            } catch (error) {
                showMessage('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² Google Sheets', 'error');
            }
        }
        
        function clearLocalData() {
            if (!confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯ØŸ Ø§ÛŒÙ† Ø¹Ù…Ù„ Ù‚Ø§Ø¨Ù„ Ø¨Ø±Ú¯Ø´Øª Ù†ÛŒØ³Øª.')) {
                return;
            }
            
            localStorage.removeItem('customers');
            localStorage.removeItem('debts');
            localStorage.removeItem('payments');
            localStorage.removeItem('lastSync');
            
            customers = [];
            debts = [];
            payments = [];
            
            loadCustomers();
            loadDebts();
            loadPayments();
            updateDashboardStats();
            updateSyncStats();
            
            showMessage('âœ… Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯', 'success');
        }
        
        function downloadFullBackup() {
            const allData = {
                customers: customers,
                debts: debts,
                payments: payments,
                lastSync: localStorage.getItem('lastSync'),
                backupDate: new Date().toLocaleString('fa-IR'),
                totalRecords: customers.length + debts.length + payments.length
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const blob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `Ù¾Ø´ØªÛŒØ¨Ø§Ù†_Ú©Ø§Ù…Ù„_Ù…Ø¯ÛŒØ±ÛŒØª_Ø§Ù‚Ø³Ø§Ø·_${new Date().toLocaleDateString('fa-IR')}.json`;
            
            link.click();
            
            showMessage('âœ… Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ú©Ø§Ù…Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯', 'success');
        }
        
        function openGoogleSheets() {
            window.open('https://docs.google.com/spreadsheets/', '_blank');
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ====================
        function formatCurrency(amount) {
            return new Intl.NumberFormat('fa-IR').format(amount) + ' Ø±ÛŒØ§Ù„';
        }
        
        function isValidJalaliDate(dateStr) {
            if (!dateStr) return false;
            const regex = /^[0-9]{4}\/[0-9]{1,2}\/[0-9]{1,2}$/;
            if (!regex.test(dateStr)) return false;
            const m = moment(dateStr, 'jYYYY/jMM/jDD');
            return m.isValid();
        }
        
        function showMessage(text, type = 'info') {
            // Ø­Ø°Ù Ù¾ÛŒØºØ§Ù… Ù‚Ø¨Ù„ÛŒ
            const oldMsg = document.getElementById('globalMessage');
            if (oldMsg) oldMsg.remove();
            
            // Ø±Ù†Ú¯â€ŒÙ‡Ø§
            const colors = {
                success: '#27ae60',
                warning: '#f39c12',
                error: '#e74c3c',
                info: '#3498db'
            };
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ù¾ÛŒØºØ§Ù…
            const msg = document.createElement('div');
            msg.id = 'globalMessage';
            msg.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type]};
                color: white;
                padding: 15px 25px;
                border-radius: 5px;
                z-index: 9999;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                font-family: Tahoma;
                max-width: 400px;
                animation: slideIn 0.3s ease;
            `;
            
            const icons = {
                success: 'fa-check-circle',
                warning: 'fa-exclamation-triangle',
                error: 'fa-times-circle',
                info: 'fa-info-circle'
            };
            
            msg.innerHTML = `
                <i class="fas ${icons[type]}"></i>
                ${text}
                <button onclick="this.parentElement.remove()" style="
                    background: none;
                    border: none;
                    color: white;
                    margin-right: 15px;
                    cursor: pointer;
                ">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            document.body.appendChild(msg);
            
            // Ø­Ø°Ù Ø®ÙˆØ¯Ú©Ø§Ø±
            setTimeout(() => {
                if (msg.parentElement) {
                    msg.style.opacity = '0';
                    msg.style.transition = 'opacity 0.3s';
                    setTimeout(() => msg.remove(), 300);
                }
            }, 5000);
        }
        
        function exportToCSV(type) {
            let data, headers, filename;
            
            switch(type) {
                case 'customers':
                    data = customers;
                    headers = ['Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ', 'Ù†Ø§Ù…', 'Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ', 'Ú©Ø¯ Ù…Ù„ÛŒ', 'ØªØ§Ø±ÛŒØ® Ø§Ø³ØªØ®Ø¯Ø§Ù…', 'ÙˆØ¶Ø¹ÛŒØª'];
                    filename = 'Ù…Ø´ØªØ±ÛŒØ§Ù†.csv';
                    break;
                    
                case 'debts':
                    data = debts.map(debt => {
                        const paid = payments.filter(p => p.debt_id === debt.id)
                            .reduce((sum, p) => sum + p.amount, 0);
                        const remaining = debt.amount - paid;
                        const paidInstallments = payments.filter(p => p.debt_id === debt.id).length;
                        
                        return {
                            'Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯': debt.id,
                            'Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ': debt.employee_code,
                            'Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ': debt.customer_name,
                            'Ù…Ø¨Ù„Øº Ú©Ù„': debt.amount,
                            'ØªØ¹Ø¯Ø§Ø¯ Ø§Ù‚Ø³Ø§Ø·': debt.installments,
                            'Ù…Ø¨Ù„Øº Ù‡Ø± Ù‚Ø³Ø·': debt.installment_amount,
                            'ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª': debt.date,
                            'Ø§Ù‚Ø³Ø§Ø· Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡': paidInstallments,
                            'Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡': paid,
                            'Ù…Ø§Ù†Ø¯Ù‡ Ø¨Ø¯Ù‡ÛŒ': remaining,
                            'ÙˆØ¶Ø¹ÛŒØª': remaining > 0 ? 'Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª' : 'ØªØ³ÙˆÛŒÙ‡ Ø´Ø¯Ù‡'
                        };
                    });
                    headers = ['Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯', 'Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ', 'Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ', 'Ù…Ø¨Ù„Øº Ú©Ù„', 'ØªØ¹Ø¯Ø§Ø¯ Ø§Ù‚Ø³Ø§Ø·', 'Ù…Ø¨Ù„Øº Ù‡Ø± Ù‚Ø³Ø·', 'ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª', 'Ø§Ù‚Ø³Ø§Ø· Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡', 'Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡', 'Ù…Ø§Ù†Ø¯Ù‡ Ø¨Ø¯Ù‡ÛŒ', 'ÙˆØ¶Ø¹ÛŒØª'];
                    filename = 'Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§.csv';
                    break;
                    
                case 'payments':
                    data = payments.map(payment => ({
                        'Ø´Ù…Ø§Ø±Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª': payment.id,
                        'Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ': payment.employee_code,
                        'Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ': payment.customer_name,
                        'Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯': payment.debt_id,
                        'Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ': payment.amount,
                        'Ø´Ù…Ø§Ø±Ù‡ Ù‚Ø³Ø·': payment.installment_number,
                        'ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª': payment.date,
                        'Ù…Ø§Ù‡': payment.month,
                        'Ø³Ø§Ù„': payment.year,
                        'ØªÙˆØ¶ÛŒØ­Ø§Øª': payment.description
                    }));
                    headers = ['Ø´Ù…Ø§Ø±Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª', 'Ú©Ø¯ Ù¾Ø±Ø³Ù†Ù„ÛŒ', 'Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ', 'Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯', 'Ù…Ø¨Ù„Øº Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ', 'Ø´Ù…Ø§Ø±Ù‡ Ù‚Ø³Ø·', 'ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª', 'Ù…Ø§Ù‡', 'Ø³Ø§Ù„', 'ØªÙˆØ¶ÛŒØ­Ø§Øª'];
                    filename = 'Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§.csv';
                    break;
                    
                default:
                    return;
            }
            
            let csvContent = headers.join(',') + '\n';
            
            data.forEach(item => {
                const row = headers.map(header => {
                    let value = item[header] || '';
                    
                    if (typeof value === 'string' && value.includes(',')) {
                        value = `"${value}"`;
                    }
                    
                    return value;
                });
                
                csvContent += row.join(',') + '\n';
            });
            
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
            
            showMessage('ÙØ§ÛŒÙ„ CSV Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø±ÙˆØ¹ Ø´Ø¯', 'success');
        }
        
        function backupData() {
            const allData = {
                customers: customers,
                debts: debts,
                payments: payments,
                backupDate: new Date().toLocaleString('fa-IR')
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', `backup_management_${moment().format('jYYYY-jMM-jDD')}.json`);
            link.click();
            
            showMessage('Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'success');
        }
        
        function restoreData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const backup = JSON.parse(e.target.result);
                        
                        if (confirm('Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù† Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø´ÙˆÙ†Ø¯ØŸ')) {
                            customers = backup.customers || [];
                            debts = backup.debts || [];
                            payments = backup.payments || [];
                            
                            saveData();
                            loadCustomers();
                            loadDebts();
                            loadPayments();
                            updateDashboardStats();
                            updateSyncStats();
                            
                            showMessage('Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯Ù†Ø¯', 'success');
                        }
                    } catch (error) {
                        showMessage('Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù†: ' + error.message, 'error');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>